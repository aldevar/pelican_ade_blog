<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>    Accéder en webdav à son fichier Keepass
</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
            <link rel="stylesheet" href="../../theme/css/normalize.css">
        <link href='//fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Oswald' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="../../theme/css/font-awesome.min.css">
        <link rel="stylesheet" href="../../theme/css/main.css">

    <link rel="stylesheet" href="../../theme/css/blog.css">
    <link rel="stylesheet" href="../../theme/css/github.css">
        <link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Aldevar - Le Blog Atom Feed" />
        <script src="../../theme/js/vendor/modernizr-2.6.2.min.js"></script>
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->

        <div id="wrapper">
<header id="sidebar" class="side-shadow">
    <hgroup id="site-header">
        <a id="site-title" href="../.."><h1><i class="icon-coffee"></i> Aldevar - Le Blog</h1></a>
        <p id="site-desc"> Un Blog IT </p>
    </hgroup>
    <nav>
        <ul id="nav-links">
        </ul>
    </nav>
<footer id="site-info">
    <p>
        Proudly powered by <a href="http://getpelican.com/" target="pelican">Pelican</a> and <a href="http://python.org/" target="python">Python</a>. Theme by <a href="https://github.com/hdra/pelican-cait" target="github">hndr</a>.
    </p>
    <p>
        Textures by <a href="http://subtlepatterns.com/" target="subtlepatterns">Subtle Pattern</a>. Font Awesome by <a href="http://fortawesome.github.io/Font-Awesome/" target="github">Dave Grandy</a>.
    </p>
</footer></header>
    <div id="post-container">
        <ol id="post-list">
            <li>
                <article class="post-entry">
                    <header class="entry-header">
                        <time class="post-time" datetime="2014-09-05T22:54:00+02:00" pubdate>
                            Fri 05 September 2014
                        </time>
                        <a href="../../2014/09/acceder-en-webdav-a-son-fichier-keepass.html" rel="bookmark"><h1>Accéder en webdav à son fichier Keepass</h1></a>
                    </header>

                    <section class="post-content">
                        <p>Keepass est un gestionnaire de mot de passe que j'utilise
personnellement et professionnellement. Il permet notamment de partager
un coffre fort entre plusieurs personne en offrant un support pour ftp
et http/webdav. Certains plugins ajoutent le support sftp et ftps.</p>
<p>Sur CentOS, apache est livré avec le module webdav. Ce n'est pas
forcement le cas de toutes les distributions.</p>
<p>La configuration utilisée est la suivante :</p>
<ul class="simple">
<li>Un sous domaine créé pour contenir le fichier kdbx</li>
<li>une protection par mot de passe pour l'accès au fichier en lui même
(anciennement .htaccess)</li>
<li>L'autorisation d'accéder au sous domaine en webdav</li>
<li>Et enfin, un mot de passe <strong>ultra solide</strong> pour le fichier kdbx qui
peut contenir des données sensibles.</li>
</ul>
<p>Dans mon cas, j'ai utilisé un sous domaine du type keepass.domain.tld et
le fichier est stocké en local sur le serveur sous /var/www/keepass/</p>
<pre class="literal-block">
root# mkdir /var/www/keepass
root# chown apache. /var/www/keepass
root# chmod 770 /var/www/keepass
root# vim /etc/httpd/conf.d/keepass.conf
</pre>
<p>Pour ne pas que le mot de passe passe en clair sur le net, nous allons
forcer l'utilisation de https</p>
<pre class="literal-block">
&lt;VirtualHost *:80&gt;
 ServerName keepass.domain.tld
 ServerAdmin admin&#64;domain.tld
 Redirect permanent / https://keepass.domain.tld/
 ErrorLog /var/log/httpd/keepass.err
 CustomLog /var/log/httpd/keepass.log combined
 DocumentRoot /var/www/keepass
&lt;/VirtualHost&gt;
&lt;VirtualHost *:443&gt;
 SSLEngine on
 SSLCertificateFile /etc/pki/tls/certs/ca.crt
 SSLCertificateKeyFile /etc/pki/tls/private/ca.key
 ServerName keepass.domain.tld
 ServerAdmin admin&#64;domain.tld
 ErrorLog /var/log/httpd/keepass.err
 CustomLog /var/log/httpd/keepass.log combined
 DocumentRoot /var/www/keepass
&lt;Directory &quot;/var/www/keepass&quot;&gt;
 DAV On
 SSLRequireSSL
 Options None
 AuthType Basic
 AuthName WebDAV
 AuthUserFile /etc/httpd/conf/.htpasswd
 &lt;LimitExcept GET OPTIONS&gt;
 Order allow,deny
 Allow from X.X.X.X #IP que vous autorisez, 'all' pour tout le monde
 Require valid-user
 &lt;/LimitExcept&gt;
&lt;/Directory&gt;
&lt;/VirtualHost&gt;
</pre>
<p>Voici les étapes pour la création du fichier .htpasswd</p>
<pre class="literal-block">
root# htpasswd -c /etc/httpd/conf/.htpasswd NomUtilisateur
root# /etc/init.d/httpd restart
</pre>
<p>Il ne reste plus qu'à placer le fichier kdbx dans /var/www/keepass et
donner à apache les droits en écriture sur ce fichier.</p>
<p>Enfin, dans Keepass en ouvrant une url, le logiciel demande de fournir
l'URL et si besoin un couple login/mdp.</p>
<p>L'URL sera de type <a class="reference external" href="https://keepass.domain.tld/fichier.kdbx">https://keepass.domain.tld/fichier.kdbx</a> et le couple
login/mdp est celui créé lors de l’exécution de la commande htpasswd</p>

                    </section>
                    <hr/>
                    <aside class="post-meta">
                        <p>Category: <a href="../../category/tech.html">Tech</a></p>
                        <p>Tags: <a href="../../tag/apache.html">apache</a>, <a href="../../tag/centos.html">centos</a>, <a href="../../tag/keepass.html">keepass</a>, <a href="../../tag/ssl.html">ssl</a>, <a href="../../tag/webdav.html">webdav</a>, </p>
                    </aside>
                    <hr/>
                </article>
            </li>
        </ol>
    </div>
        </div>

        <script src="../../theme/js/main.js"></script>
    </body>
</html>