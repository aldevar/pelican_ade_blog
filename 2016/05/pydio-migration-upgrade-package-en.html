<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>    Pydio - migration, upgrade, package [EN]
</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
            <link rel="stylesheet" href="../../theme/css/normalize.css">
        <link href='//fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Oswald' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="../../theme/css/font-awesome.min.css">
        <link rel="stylesheet" href="../../theme/css/main.css">

    <link rel="stylesheet" href="../../theme/css/blog.css">
    <link rel="stylesheet" href="../../theme/css/github.css">
        <link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Aldevar - Le Blog Atom Feed" />
        <script src="../../theme/js/vendor/modernizr-2.6.2.min.js"></script>
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->

        <div id="wrapper">
<header id="sidebar" class="side-shadow">
    <hgroup id="site-header">
        <a id="site-title" href="../.."><h1><i class="icon-coffee"></i> Aldevar - Le Blog</h1></a>
        <p id="site-desc"> Un Blog IT </p>
    </hgroup>
    <nav>
        <ul id="nav-links">
        </ul>
    </nav>
<footer id="site-info">
    <p>
        Proudly powered by <a href="http://getpelican.com/" target="pelican">Pelican</a> and <a href="http://python.org/" target="python">Python</a>. Theme by <a href="https://github.com/hdra/pelican-cait" target="github">hndr</a>.
    </p>
    <p>
        Textures by <a href="http://subtlepatterns.com/" target="subtlepatterns">Subtle Pattern</a>. Font Awesome by <a href="http://fortawesome.github.io/Font-Awesome/" target="github">Dave Grandy</a>.
    </p>
</footer></header>
    <div id="post-container">
        <ol id="post-list">
            <li>
                <article class="post-entry">
                    <header class="entry-header">
                        <time class="post-time" datetime="2016-05-27T23:02:00+02:00" pubdate>
                            Fri 27 May 2016
                        </time>
                        <a href="../../2016/05/pydio-migration-upgrade-package-en.html" rel="bookmark"><h1>Pydio - migration, upgrade, package [EN]</h1></a>
                    </header>

                    <section class="post-content">
                        <p>Cet article est également disponible <a class="reference external" href="http://blog.devarieux.net/2016/05/pydio-migration-upgrade-package-fr/">en
français</a>.</p>
<p>This unclear title reveals an operation i've just done to make 3 moves
in one. Pydio 6.0.7 was running on a CentOS 6 server, installed via the
tar.gz archive.</p>
<p>The primary goal was to upgrade Pydio to 6.4. Unfortunately, there was
dependcies problems with php. Pydio 6.4 needs php 5.4 and CentOS only
brings 5.3 (you can install php 5.4 via other repos but I didn't want
this). The first was to create a new Centos7 VM, then install Pydio on
it using yum and the Pydio repo and finally import the old config in the
brand new Pydio.</p>
<p>Installing Pydio through the package manager allows you to update it
easily and it also ease the automation for an autmatic deployement.
Also, the plugin management is facilitated.</p>
<p>These are the steps I'll describe here.</p>
<p>Install mariadb and httpd</p>
<pre class="code sh literal-block">
yum install -y mariadb mariadb-server
systemctl start mariadb.service
systemctl <span class="nb">enable</span> mariadb.service
mysql_secure_installation
yum install httpd
systemctl <span class="nb">enable</span> httpd.service
systemctl start httpd.service
</pre>
<p>Installing Pydio dependancies :</p>
<pre class="code literal-block">
yum -y install php php-gd php-ldap php-pear php-xml php-xmlrpc php-mbstring curl php-mcrypt* php-mysql
</pre>
<p>Installing Pydio repositories</p>
<pre class="code literal-block">
wget https://download.pydio.com/pub/linux/centos/7/pydio-release-1-1.el7.centos.noarch.rpm
</pre>
<p>If you own a licence (free up to 10 users), you can also have the
enterprise repo.</p>
<pre class="code literal-block">
wget https://API_KEY:API_SECRET&#64;download.pydio.com/auth/linux/centos/7/x86_64/pydio-enterprise-release-1-1.el7.centos.noarch.rpm
</pre>
<p>With API_KEY and API_SECRET &nbsp;in your dashboard on pydio.com, licence
tab</p>
<pre class="code literal-block">
rpm -ivh pydio-release-1-1.el7.centos.noarch.rpm
rpm -ivh pydio-enterprise-release-1-1.el7.centos.noarch.rpm
</pre>
<p>Edit the repo file to add your API_KEY and API_SECRET</p>
<pre class="code literal-block">
vim /etc/yum.repos.d/pydio-enterprise.repo
</pre>
<p>InstallPydio</p>
<pre class="code literal-block">
yum update
yum install pydio-enterprise
</pre>
<p>I use to modify the default vhost file /etc/httpd/conf.d/pydio.conf</p>
<pre class="code apache literal-block">
<span class="nt">&lt;VirtualHost</span> <span class="s">nom.du.vhost:80</span><span class="nt">&gt;</span>
<span class="nb">Alias</span> / <span class="sx">/usr/share/pydio/</span>
<span class="nb">Alias</span> <span class="sx">/pydio_public</span> <span class="sx">/var/lib/pydio/public/</span>

<span class="nt">&lt;Directory</span> <span class="s">/usr/share/pydio/</span><span class="nt">&gt;</span>
<span class="nb">Options</span> FollowSymLinks
<span class="nb">AllowOverride</span> Limit FileInfo
<span class="nb">Require</span> <span class="k">all</span> granted
<span class="nb">php_value</span> error_reporting <span class="m">2</span>
<span class="nb">php_value</span> upload_max_filesize <span class="m">100</span>M
<span class="nb">php_value</span> post_max_size <span class="m">100</span>M
<span class="nb">php_value</span> output_buffering <span class="k">Off</span>

<span class="nt">&lt;/Directory&gt;</span>

<span class="nt">&lt;Directory</span> <span class="s">/var/lib/pydio/public/</span><span class="nt">&gt;</span>
<span class="nb">AllowOverride</span> Limit FileInfo
<span class="nb">Require</span> <span class="k">all</span> granted
<span class="nb">php_value</span> error_reporting <span class="m">2</span>
<span class="nt">&lt;/Directory&gt;</span>
<span class="nt">&lt;/VirtualHost&gt;</span>
</pre>
<p>Customize the charset in /etc/pydio/bootstrap_conf.php</p>
<pre class="code literal-block">
define(&quot;AJXP_LOCALE&quot;, &quot;fr_FR.UTF-8&quot;);
</pre>
<p>Create the database:</p>
<pre class="code literal-block">
mysql -u root -p
create database pydio;
create user pydio&#64;localhost identified by 'mypassword';
grant all privileges on pydio.* to pydio&#64;localhost identified by 'mypassword';
use mysql
update mysql.users set Super_Priv='Y' where user like pydio;
</pre>
<p>The last command gives the Super Privileges to the pydio user for it to
be able to create triggers.</p>
<p>Install the Pydio plugins;</p>
<pre class="code literal-block">
yum install pydio-plugin*
</pre>
<p>The last step is to import your old pydio database in your brand new one</p>
<pre class="code literal-block">
mysql -u pydio -p pydio &lt; mondumppydio.sql
</pre>
<p>Finally, you can go to the pydio page and go through the First Run
Wizard. Once done, you should be able to connect with your account and
find all your files.</p>

                    </section>
                    <hr/>
                    <aside class="post-meta">
                        <p>Category: <a href="../../category/tech.html">Tech</a></p>
                        <p>Tags: <a href="../../tag/centos.html">centos</a>, <a href="../../tag/linux.html">Linux</a>, <a href="../../tag/pydio.html">pydio</a>, </p>
                    </aside>
                    <hr/>
                </article>
            </li>
        </ol>
    </div>
        </div>

        <script src="../../theme/js/main.js"></script>
    </body>
</html>