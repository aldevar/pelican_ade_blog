<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>    Firefox comme navigateur par défaut de SailfishOS
</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
            <link rel="stylesheet" href="../../theme/css/normalize.css">
        <link href='//fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Oswald' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="../../theme/css/font-awesome.min.css">
        <link rel="stylesheet" href="../../theme/css/main.css">

    <link rel="stylesheet" href="../../theme/css/blog.css">
    <link rel="stylesheet" href="../../theme/css/github.css">
        <link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Aldevar - Le Blog Atom Feed" />
        <script src="../../theme/js/vendor/modernizr-2.6.2.min.js"></script>
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->

        <div id="wrapper">
<header id="sidebar" class="side-shadow">
    <hgroup id="site-header">
        <a id="site-title" href="../.."><h1><i class="icon-coffee"></i> Aldevar - Le Blog</h1></a>
        <p id="site-desc"> Un Blog IT </p>
    </hgroup>
    <nav>
        <ul id="nav-links">
        </ul>
    </nav>
<footer id="site-info">
    <p>
        Proudly powered by <a href="http://getpelican.com/" target="pelican">Pelican</a> and <a href="http://python.org/" target="python">Python</a>. Theme by <a href="https://github.com/hdra/pelican-cait" target="github">hndr</a>.
    </p>
    <p>
        Textures by <a href="http://subtlepatterns.com/" target="subtlepatterns">Subtle Pattern</a>. Font Awesome by <a href="http://fortawesome.github.io/Font-Awesome/" target="github">Dave Grandy</a>.
    </p>
</footer></header>
    <div id="post-container">
        <ol id="post-list">
            <li>
                <article class="post-entry">
                    <header class="entry-header">
                        <time class="post-time" datetime="2015-08-24T09:17:00+02:00" pubdate>
                            Mon 24 August 2015
                        </time>
                        <a href="../../2015/08/firefox-comme-navigateur-par-defaut-de-sailfishos.html" rel="bookmark"><h1>Firefox comme navigateur par défaut de SailfishOS</h1></a>
                    </header>

                    <section class="post-content">
                        <p>Jolla et son SailfishOS sont vraiment de beaux outils mais il faut
avouer qu'ils ont quand même un problème majeur, c'est la piètre qualité
des navigateurs intégrés et surtout du navigateur par défaut.</p>
<p>Malheureusement, l'interface ne propose actuellement aucune option pour
modifier ce comportement. Ainsi, lorsqu'on clique sur un lien dans une
autre application c'est forcement ce navigateur tout moisi qui s'ouvre
et qui met 3 heures à charger la page. Heureusement, avec quelques
bidouille, il est possible de paramétrer Firefox comme navigateur par
défaut, c'est d'ailleurs ce que je viens de faire :)</p>
<p>Si vous avez déjà Firefox d'installé, vous pouvez directement vous
rendre au paragraphe 'Paramétrage d'ADB'.</p>
<div class="section" id="installation-d-aptoide">
<h2>Installation d'Aptoide</h2>
<p>La première étape est d'installer le market Aptoide si ce n'est pas déjà
fait. Pour cela, il faut se rendre dans la Boutique Jolla, puis dans
'Place de marché' tout en bas et installer le market Aptoide Appstore</p>
<p>[gallery size=&quot;medium&quot; columns=&quot;2&quot; link=&quot;file&quot; ids=&quot;571,572&quot;]</p>
</div>
<div class="section" id="installation-de-firefox">
<h2>Installation de Firefox</h2>
<p>L'installation de Firefox se fait via Aptoide, il faut donc ouvrir
l'application nouvellement installée et dans la zone de recherche, taper
Firefox. Il faut ensuite trouver l'application <strong>Firefox Browser for
Android</strong> et l'installer.</p>
<p>[gallery link=&quot;file&quot; columns=&quot;2&quot; size=&quot;medium&quot; ids=&quot;575,576,577,578&quot;]</p>
</div>
<div class="section" id="parametrage-d-adb">
<h2>Paramétrage d'ADB</h2>
<p>C'est partie pour le bricolage. Il faut d'abord <a class="reference external" href="http://blog.devarieux.net/2015/03/se-connecter-en-ssh-a-son-jolla/">se connecter en
SSH</a>
à l'appareil afin d'y modifier le comportement d'Alien. Pour cela, il
faut éditer le fichier /opt/alien/system/build.prop et ajouter à la fin
:</p>
<pre class="literal-block">
persist.service.adb.enable=1
service.adb.tcp.port=5555
</pre>
<p>Une fois cette modification faite, on relance Alien Dalvik</p>
<pre class="literal-block">
[root&#64;Jolla ~]# systemctl restart aliendalvik.service
</pre>
<p>Maintenant, un process adb doit apparaitre</p>
<pre class="literal-block">
[root&#64;Jolla ~]# ps aux | grep adb
 shell&nbsp;&nbsp;&nbsp;&nbsp; 5162&nbsp; 0.0&nbsp; 0.0&nbsp;&nbsp; 6532&nbsp;&nbsp;&nbsp; 92 ?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Ssl&nbsp; 23:04&nbsp;&nbsp; 0:00 /system/root/sbin/adbd
 root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5592&nbsp; 0.0&nbsp; 0.0&nbsp;&nbsp; 3984&nbsp;&nbsp; 288 pts/0&nbsp;&nbsp;&nbsp; Sl&nbsp;&nbsp; 23:06&nbsp;&nbsp; 0:00 adb fork-server server
 root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 7330&nbsp; 0.0&nbsp; 0.0&nbsp;&nbsp; 2256&nbsp;&nbsp; 544 pts/0&nbsp;&nbsp;&nbsp; S+&nbsp;&nbsp; 23:57&nbsp;&nbsp; 0:00 grep adb
</pre>
<pre class="literal-block">
[root&#64;Jolla ~]# lsof -p 5162 | grep android_adb
 adbd&nbsp;&nbsp;&nbsp; 5162 shell&nbsp;&nbsp; 10u&nbsp;&nbsp; CHR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10,25&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0t0&nbsp; 1437 /opt/alien/dev/android_adb
</pre>
<p>Une fois que tout ça est ok, on lance en root :</p>
<pre class="literal-block">
[root&#64;localhost bin]# /opt/alien/system/bin/adb kill-server
[root&#64;localhost bin]# /opt/alien/system/bin/adb devices
* daemon not running. starting it now on port 5038 *
* daemon started successfully *
List of devices attached
emulator-5554   device

[root&#64;localhost bin]#
</pre>
</div>
<div class="section" id="parametrage-de-sailfishos">
<h2>Paramétrage de SailfishOS</h2>
<p>La système est maintenant prêt à accueillir nos modifications. Toujours
dans la connexion SSH, se rendre dans /usr/share/applications, faire une
copie de sauvegarde du fichier open-url.desktop et le modifier pour
qu'il ne prenne plus en charge les types MIME http et https</p>
<pre class="literal-block">
cd /usr/share/applications
cp -a open-url.desktop open-url.desktop.ori
vi open-url.desktop
</pre>
<p>Une fois dans le fichier, on supprime la ligne</p>
<pre class="code literal-block">
MimeType=text/html;x-maemo-urischeme/http;x-maemo-urischeme/https;
</pre>
<p>Le fichier doit maintenant ressembler à cela</p>
<pre class="literal-block">
[root&#64;Jolla applications]# cat open-url.desktop
[Desktop Entry]
Type=Application
Name=Browser
NotShowIn=X-MeeGo;
X-MeeGo-Logical-Id=sailfish-browser-ap-name
X-MeeGo-Translation-Catalog=sailfish-browser
X-Maemo-Service=org.sailfishos.browser
X-Maemo-Method=org.sailfishos.browser.openUrl
</pre>
<p>Créer ensuite le fichier firefox-as-default.desktop et y mettre ce
contenu</p>
<pre class="literal-block">
[Desktop Entry]
Type=Application
Name=Browser
NotShowIn=X-MeeGo;
X-MeeGo-Logical-Id=sailfish-browser-ap-name
X-MeeGo-Translation-Catalog=sailfish-browser
X-Maemo-Service=org.sailfishos.browser
X-Maemo-Method=org.sailfishos.browser.openUrl
[root&#64;Jolla applications]# cat firefox-as-default.desktop
[Desktop Entry]
Exec=/opt/alien/system/bin/adb -e shell am start -a android.intent.action.VIEW -n org.mozilla.firefox/.App -d ' %U'
Name=Firefox HTTP handler (opener)
Type=Application
MimeType=text/html;x-maemo-urischeme/http;x-maemo-urischeme/https;
X-Nemo-Application-Type=no-invoker
X-Nemo-Single-Instance=no
X-apkd-apkfile=/data/app/org.mozilla.firefox.apk
NoDisplay=true
</pre>
<p>Afin de prendre ces modifications en compte, on met à jour le cache des
types MIME</p>
<pre class="literal-block">
[root&#64;Jolla applications]# update-desktop-database
</pre>
<p>Le fichier mimeinfo.cache devrait maintenant contenir 2 lignes de ce
type</p>
<pre class="literal-block">
x-maemo-urischeme/http=firefox-as-default.desktop;
x-maemo-urischeme/https=firefox-as-default.desktop;
</pre>
<p>Dorénavant, lorsqu'un lien sera cliqué dans une application (message,
twitter...) celui s'ouvrir avec Firefox.</p>
</div>

                    </section>
                    <hr/>
                    <aside class="post-meta">
                        <p>Category: <a href="../../category/tech.html">Tech</a></p>
                    </aside>
                    <hr/>
                </article>
            </li>
        </ol>
    </div>
        </div>

        <script src="../../theme/js/main.js"></script>
    </body>
</html>